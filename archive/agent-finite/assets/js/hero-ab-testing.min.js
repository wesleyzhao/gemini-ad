class HeroABTesting{constructor(t={}){this.options={storagePrefix:"gemini_hero_",testDuration:7,enableTracking:!0,onVariantShown:null,onVariantInteraction:null,debug:!1,...t},this.currentVariants={},this.trackingData=this.loadTrackingData(),this.init()}init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.setupVariants()):this.setupVariants()}setupVariants(){document.querySelectorAll("[data-hero-variants]").forEach((t,a)=>{try{const e=JSON.parse(t.getAttribute("data-hero-variants")),i=t.id||`hero-${a}`;t.id||(t.id=i);const n=this.selectVariant(i,e);this.applyVariant(t,n),this.trackVariantShown(i,n,e),this.setupInteractionTracking(t,i,n),this.log(`Applied variant "${n.text}" to #${i}`)}catch(t){console.error("Error parsing hero variants:",t)}}),this.setupSubtitleVariants()}setupSubtitleVariants(){document.querySelectorAll("[data-subtitle-variants]").forEach((t,a)=>{try{const e=JSON.parse(t.getAttribute("data-subtitle-variants")),i=t.id||`subtitle-${a}`;t.id||(t.id=i);const n=this.selectVariant(i,e);this.applyVariant(t,n),this.trackVariantShown(i,n,e),this.log(`Applied subtitle variant "${n.text}" to #${i}`)}catch(t){console.error("Error parsing subtitle variants:",t)}})}selectVariant(t,a){const e=this.options.storagePrefix+t,i=this.getStoredVariant(e);if(i&&this.isVariantValid(i)){const t=this.findVariantByText(a,i.text);if(t)return t}const n=this.getRandomVariant(a);return this.storeVariant(e,n),n}getRandomVariant(t){if(0===t.length)return{text:"",weight:1};const a=t.map(t=>"string"==typeof t?{text:t,weight:1}:t),e=a.reduce((t,a)=>t+(a.weight||1),0);let i=Math.random()*e;for(const t of a)if(i-=t.weight||1,i<=0)return t;return a[0]}findVariantByText(t,a){return t.map(t=>"string"==typeof t?{text:t,weight:1}:t).find(t=>t.text===a)}applyVariant(t,a){t.innerHTML.includes("<")&&a.text.includes("<br>")?t.innerHTML=a.text:t.textContent=a.text,t.setAttribute("data-current-variant",a.text)}storeVariant(t,a){try{const e={text:a.text,timestamp:Date.now()};localStorage.setItem(t,JSON.stringify(e))}catch(t){this.log("Could not store variant:",t)}}getStoredVariant(t){try{const a=localStorage.getItem(t);return a?JSON.parse(a):null}catch(t){return this.log("Could not retrieve stored variant:",t),null}}isVariantValid(t){return Date.now()-t.timestamp<24*this.options.testDuration*60*60*1e3}trackVariantShown(t,a,e){const i=window.location.pathname;this.trackingData[i]||(this.trackingData[i]={}),this.trackingData[i][t]||(this.trackingData[i][t]={variants:{},totalImpressions:0}),this.trackingData[i][t].variants[a.text]||(this.trackingData[i][t].variants[a.text]={impressions:0,clicks:0,conversions:0}),this.trackingData[i][t].variants[a.text].impressions++,this.trackingData[i][t].totalImpressions++,this.saveTrackingData(),this.options.onVariantShown&&this.options.onVariantShown({page:i,elementId:t,variant:a.text,allVariants:e.map(t=>"string"==typeof t?t:t.text)}),this.options.enableTracking&&"undefined"!=typeof gtag&&gtag("event","hero_variant_shown",{page_path:i,element_id:t,variant:a.text})}setupInteractionTracking(t,a,e){const i=t.closest("section, .hero, .hero-section");if(!i)return;i.querySelectorAll("a.btn, button.btn, .hero-cta a, .hero-cta button").forEach(t=>{t.addEventListener("click",()=>{this.trackVariantInteraction(a,e,"click")})})}trackVariantInteraction(t,a,e="click"){const i=window.location.pathname;this.trackingData[i]&&this.trackingData[i][t]&&this.trackingData[i][t].variants[a.text]&&("click"===e?this.trackingData[i][t].variants[a.text].clicks++:"conversion"===e&&this.trackingData[i][t].variants[a.text].conversions++,this.saveTrackingData()),this.options.onVariantInteraction&&this.options.onVariantInteraction({page:i,elementId:t,variant:a.text,interactionType:e}),this.options.enableTracking&&"undefined"!=typeof gtag&&gtag("event",`hero_variant_${e}`,{page_path:i,element_id:t,variant:a.text})}loadTrackingData(){try{const t=localStorage.getItem("gemini_hero_tracking");return t?JSON.parse(t):{}}catch(t){return this.log("Could not load tracking data:",t),{}}}saveTrackingData(){try{localStorage.setItem("gemini_hero_tracking",JSON.stringify(this.trackingData))}catch(t){this.log("Could not save tracking data:",t)}}getReport(t=null){return t?this.trackingData[t]||{}:this.trackingData}getPerformanceMetrics(t=window.location.pathname,a=null){const e=this.trackingData[t];if(!e)return null;if(a)return this.calculateMetrics(e[a]);const i={};return Object.keys(e).forEach(t=>{i[t]=this.calculateMetrics(e[t])}),i}calculateMetrics(t){if(!t||!t.variants)return null;const a={totalImpressions:t.totalImpressions,variants:{}};return Object.entries(t.variants).forEach(([t,e])=>{const i=e.impressions>0?(e.clicks/e.impressions*100).toFixed(2):0,n=e.clicks>0?(e.conversions/e.clicks*100).toFixed(2):0;a.variants[t]={impressions:e.impressions,clicks:e.clicks,conversions:e.conversions,ctr:parseFloat(i),conversionRate:parseFloat(n)}}),a}exportData(){return JSON.stringify(this.trackingData,null,2)}clearData(){this.trackingData={},this.saveTrackingData(),Object.keys(localStorage).forEach(t=>{t.startsWith(this.options.storagePrefix)&&localStorage.removeItem(t)})}refreshVariant(t){const a=document.getElementById(t);if(!a)return;const e=a.getAttribute("data-hero-variants")||a.getAttribute("data-subtitle-variants");if(e)try{const i=JSON.parse(e),n=this.getRandomVariant(i);this.applyVariant(a,n),this.storeVariant(this.options.storagePrefix+t,n),this.log(`Refreshed variant for #${t}: "${n.text}"`)}catch(t){console.error("Error refreshing variant:",t)}}log(...t){this.options.debug&&console.log("[HeroABTesting]",...t)}}let heroABTesting;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{heroABTesting=new HeroABTesting({debug:!1})}):heroABTesting=new HeroABTesting({debug:!1}),window.HeroABTesting=HeroABTesting,window.heroABTesting=heroABTesting,console.log("%cðŸ“Š Hero A/B Testing Active","color: #4285f4; font-size: 14px; font-weight: bold;"),console.log("%cUse heroABTesting.getReport() to view results","color: #666; font-size: 12px;"),console.log("%cUse heroABTesting.getPerformanceMetrics() to see conversion data","color: #666; font-size: 12px;");